<script>
    class GyroData {
        constructor(targetElement, orientationHandler) {
            this.targetElement = targetElement;
            this.oHandler = orientationHandler;

            targetElement.addEventListener('click', function(){
                let _oHandler = this.oHandler;// jw: no longer needed?
                // initiate permission request for device gyro data access
                try {
                    if (typeof DeviceMotionEvent.requestPermission === 'function') {
                        // iOS 13+ devices
                        DeviceMotionEvent.requestPermission()
                        .then((state) => {
                            if (state === 'granted') {
                                window.addEventListener('devicemotion', _oHandler);
                            } else {
                                console.error('Request to access the orientation was rejected');
                            }
                        })
                    } else {
                        // Non iOS 13+ devices
                        window.addEventListener('devicemotion', _oHandler);
                    }
                } catch (error) {
                    // Handle desktop browsers
                    console.error('DeviceMotion Events not supported in this browser');
                    let event = new Event("NoDeviceMotion", {bubbles: true});
                    dispatchEvent(event);
                }
            }.bind(this), false);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        // define a target DOM element for user to tap
        btn = document.getElementById('btn');
        displayDiv = document.getElementById('display');

        // use GyroData instance for requesting gyro event data within handleOrientation
        const gyObj = new GyroData(btn, handleOrientation);
    });

    function handleOrientation(event) {
        // jw: need to desctructure this ?
        const alpha = event.rotationRate.alpha;
        const beta = event.rotationRate.beta;
        const gamma = event.rotationRate.gamma;
        console.log(event);

        displayDiv.textContent = alpha+', '+beta+', '+gamma;
    }

    let displayDiv;
    let btn;

</script>
<div id='display'>no data yet</div>
<button id='btn' style="background-color:cornflowerblue; border-radius: 20px; width:100%; font-size:40px">
    Start monitoring gyro
</button>